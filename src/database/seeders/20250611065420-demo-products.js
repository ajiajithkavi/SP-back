'use strict';

/** @type {import('sequelize-cli').Migration} */
module.exports = {
  up: async (queryInterface, Sequelize) => {
    // Check if products already exist
    const existingProducts = await queryInterface.sequelize.query(
      'SELECT id FROM products LIMIT 1',
      { type: queryInterface.sequelize.QueryTypes.SELECT }
    );

    // If products already exist, skip seeding
    if (existingProducts && existingProducts.length > 0) {
      console.log('Products already exist, skipping seeding');
      return;
    }

    // 1. Create a lookup for brand names to IDs (assuming order in brands seeder)
    const brandNameToId = {
      'LG': 1,
      'Samsung': 2,
      'Whirlpool': 3,
      'Godrej': 4,
      'Haier': 5,
      'Panasonic': 6,
      'Bosch': 7,
      'Hitachi': 8,
      'IFB': 9,
      'Voltas': 10,
      'Blue Star': 11,
      'Symphony': 12,
      'Crompton': 13,
      'Daikin': 14,
      'Kenstar': 15,
      'Preethi': 16,
      'Philips': 17,
      'Bajaj': 18,
      'Prestige': 19,
      'Morphy Richards': 20,
      'Butterfly': 21,
      'Sujata': 22,
      'Kent': 23,
      'Sony': 24,
      'TCL': 25,
      'OnePlus': 26,
      'Vu': 27,
      'Mi': 28,
      'Havells': 29,
      'Usha': 30,
      'Orient': 31,
      'V-Guard': 32,
      'Khaitan': 33,
      'Polycab': 34
    };

    // First, create the products
    await queryInterface.bulkInsert('products', [
      // Refrigerators (category_id: 100)
      {
        id: 1,
        name: 'LG Double Door Refrigerator',
        description: '260L Frost Free Double Door',
        slug: 'lg-double-door-refrigerator',
        sku: 'REF-001',
        price: 24999.99,
        stock: 20,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['LG'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 2,
        name: 'Samsung Single Door Refrigerator',
        description: '192L Direct Cool Single Door',
        slug: 'samsung-single-door-refrigerator',
        sku: 'REF-002',
        price: 15999.99,
        stock: 15,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Samsung'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 3,
        name: 'Whirlpool Multi Door Refrigerator',
        description: '300L Multi Door',
        slug: 'whirlpool-multi-door-refrigerator',
        sku: 'REF-003',
        price: 28999.99,
        stock: 10,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Whirlpool'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 4,
        name: 'Godrej Mini Refrigerator',
        description: '99L Mini Fridge',
        slug: 'godrej-mini-refrigerator',
        sku: 'REF-004',
        price: 8999.99,
        stock: 25,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Godrej'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 5,
        name: 'Haier Side by Side Refrigerator',
        description: '570L Side by Side',
        slug: 'haier-side-by-side-refrigerator',
        sku: 'REF-005',
        price: 49999.99,
        stock: 8,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Haier'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 6,
        name: 'Panasonic Inverter Refrigerator',
        description: '307L Inverter Refrigerator',
        slug: 'panasonic-inverter-refrigerator',
        sku: 'REF-006',
        price: 21999.99,
        stock: 12,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Panasonic'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 7,
        name: 'Bosch Bottom Freezer Refrigerator',
        description: '350L Bottom Freezer',
        slug: 'bosch-bottom-freezer-refrigerator',
        sku: 'REF-007',
        price: 32999.99,
        stock: 9,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Bosch'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 8,
        name: 'Hitachi French Door Refrigerator',
        description: '456L French Door',
        slug: 'hitachi-french-door-refrigerator',
        sku: 'REF-008',
        price: 55999.99,
        stock: 7,
        category_id: 100,
        status: true,
        brand_id: brandNameToId['Hitachi'],
        created_at: new Date(),
        updated_at: new Date()
      },
      // Washing Machines (category_id: 101)
      {
        id: 9,
        name: 'LG Front Load Washing Machine',
        description: '6kg Inverter Front Load',
        slug: 'lg-front-load-washing-machine',
        sku: 'WM-001',
        price: 22999.99,
        stock: 12,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['LG'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 10,
        name: 'Samsung Top Load Washing Machine',
        description: '7kg Top Load',
        slug: 'samsung-top-load-washing-machine',
        sku: 'WM-002',
        price: 17999.99,
        stock: 18,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['Samsung'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 11,
        name: 'Whirlpool Semi Automatic Washing Machine',
        description: '7.5kg Semi Automatic',
        slug: 'whirlpool-semi-automatic-washing-machine',
        sku: 'WM-003',
        price: 12999.99,
        stock: 20,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['Whirlpool'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 12,
        name: 'Bosch Fully Automatic Washing Machine',
        description: '8kg Fully Automatic',
        slug: 'bosch-fully-automatic-washing-machine',
        sku: 'WM-004',
        price: 25999.99,
        stock: 10,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['Bosch'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 13,
        name: 'IFB Top Load Washing Machine',
        description: '6.5kg Top Load',
        slug: 'ifb-top-load-washing-machine',
        sku: 'WM-005',
        price: 15999.99,
        stock: 14,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['IFB'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 14,
        name: 'Panasonic Fully Automatic Washing Machine',
        description: '7kg Fully Automatic',
        slug: 'panasonic-fully-automatic-washing-machine',
        sku: 'WM-006',
        price: 18999.99,
        stock: 11,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['Panasonic'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 15,
        name: 'Godrej Semi Automatic Washing Machine',
        description: '6kg Semi Automatic',
        slug: 'godrej-semi-automatic-washing-machine',
        sku: 'WM-007',
        price: 10999.99,
        stock: 13,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['Godrej'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 16,
        name: 'Haier Top Load Washing Machine',
        description: '7.5kg Top Load',
        slug: 'haier-top-load-washing-machine',
        sku: 'WM-008',
        price: 16999.99,
        stock: 10,
        category_id: 101,
        status: true,
        brand_id: brandNameToId['Haier'],
        created_at: new Date(),
        updated_at: new Date()
      },
      // Air Conditioners & Coolers (category_id: 102)
      {
        id: 17,
        name: 'LG Split AC',
        description: '1.5 Ton 5 Star Split AC',
        slug: 'lg-split-ac',
        sku: 'AC-001',
        price: 34999.99,
        stock: 10,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['LG'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 18,
        name: 'Voltas Window AC',
        description: '1.5 Ton 3 Star Window AC',
        slug: 'voltas-window-ac',
        sku: 'AC-002',
        price: 25999.99,
        stock: 8,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Voltas'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 19,
        name: 'Blue Star Tower AC',
        description: '2 Ton Tower AC',
        slug: 'blue-star-tower-ac',
        sku: 'AC-003',
        price: 49999.99,
        stock: 5,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Blue Star'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 20,
        name: 'Symphony Air Cooler',
        description: '70L Desert Air Cooler',
        slug: 'symphony-air-cooler',
        sku: 'AC-004',
        price: 8999.99,
        stock: 20,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Symphony'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 21,
        name: 'Crompton Personal Cooler',
        description: '20L Personal Air Cooler',
        slug: 'crompton-personal-cooler',
        sku: 'AC-005',
        price: 5999.99,
        stock: 25,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Crompton'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 22,
        name: 'Daikin Inverter Split AC',
        description: '1.8 Ton Inverter Split AC',
        slug: 'daikin-inverter-split-ac',
        sku: 'AC-006',
        price: 42999.99,
        stock: 7,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Daikin'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 23,
        name: 'Hitachi Window AC',
        description: '1.5 Ton Window AC',
        slug: 'hitachi-window-ac',
        sku: 'AC-007',
        price: 28999.99,
        stock: 9,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Hitachi'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 24,
        name: 'Kenstar Tower Cooler',
        description: '40L Tower Air Cooler',
        slug: 'kenstar-tower-cooler',
        sku: 'AC-008',
        price: 7999.99,
        stock: 11,
        category_id: 102,
        status: true,
        brand_id: brandNameToId['Kenstar'],
        created_at: new Date(),
        updated_at: new Date()
      },
      // Kitchen Appliances (category_id: 103)
      {
        id: 25,
        name: 'Preethi Mixer Grinder',
        description: '750W Mixer Grinder',
        slug: 'preethi-mixer-grinder',
        sku: 'KA-001',
        price: 4999.99,
        stock: 30,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Preethi'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 26,
        name: 'Philips Air Fryer',
        description: 'Rapid Air Technology',
        slug: 'philips-air-fryer',
        sku: 'KA-002',
        price: 7999.99,
        stock: 18,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Philips'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 27,
        name: 'Bajaj Electric Kettle',
        description: '1.5L Electric Kettle',
        slug: 'bajaj-electric-kettle',
        sku: 'KA-003',
        price: 1999.99,
        stock: 22,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Bajaj'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 28,
        name: 'Prestige Induction Cooktop',
        description: '2000W Induction Cooktop',
        slug: 'prestige-induction-cooktop',
        sku: 'KA-004',
        price: 3499.99,
        stock: 16,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Prestige'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 29,
        name: 'Morphy Richards OTG',
        description: '28L Oven Toaster Grill',
        slug: 'morphy-richards-otg',
        sku: 'KA-005',
        price: 8999.99,
        stock: 10,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Morphy Richards'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 30,
        name: 'Butterfly Wet Grinder',
        description: '2L Wet Grinder',
        slug: 'butterfly-wet-grinder',
        sku: 'KA-006',
        price: 5999.99,
        stock: 14,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Butterfly'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 31,
        name: 'Sujata Juicer Mixer',
        description: '900W Juicer Mixer',
        slug: 'sujata-juicer-mixer',
        sku: 'KA-007',
        price: 6499.99,
        stock: 12,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Sujata'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 32,
        name: 'Kent Water Purifier',
        description: 'RO+UV+UF Water Purifier',
        slug: 'kent-water-purifier',
        sku: 'KA-008',
        price: 11999.99,
        stock: 9,
        category_id: 103,
        status: true,
        brand_id: brandNameToId['Kent'],
        created_at: new Date(),
        updated_at: new Date()
      },
      // Televisions (category_id: 104)
      {
        id: 33,
        name: 'Sony Bravia 4K TV',
        description: '55 inch Ultra HD Smart TV',
        slug: 'sony-bravia-4k-tv',
        sku: 'TV-001',
        price: 59999.99,
        stock: 7,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['Sony'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 34,
        name: 'Samsung Crystal UHD TV',
        description: '50 inch 4K Smart TV',
        slug: 'samsung-crystal-uhd-tv',
        sku: 'TV-002',
        price: 44999.99,
        stock: 9,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['Samsung'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 35,
        name: 'LG OLED TV',
        description: '48 inch OLED Smart TV',
        slug: 'lg-oled-tv',
        sku: 'TV-003',
        price: 79999.99,
        stock: 5,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['LG'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 36,
        name: 'TCL Android TV',
        description: '43 inch Full HD Android TV',
        slug: 'tcl-android-tv',
        sku: 'TV-004',
        price: 29999.99,
        stock: 12,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['TCL'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 37,
        name: 'OnePlus Q1 Series TV',
        description: '55 inch QLED TV',
        slug: 'oneplus-q1-series-tv',
        sku: 'TV-005',
        price: 69999.99,
        stock: 6,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['OnePlus'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 38,
        name: 'Panasonic 4K Smart TV',
        description: '65 inch 4K Smart TV',
        slug: 'panasonic-4k-smart-tv',
        sku: 'TV-006',
        price: 74999.99,
        stock: 8,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['Panasonic'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 39,
        name: 'Vu Premium Android TV',
        description: '43 inch Android TV',
        slug: 'vu-premium-android-tv',
        sku: 'TV-007',
        price: 25999.99,
        stock: 10,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['Vu'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 40,
        name: 'Mi 4A Pro TV',
        description: '32 inch HD Ready Smart TV',
        slug: 'mi-4a-pro-tv',
        sku: 'TV-008',
        price: 15999.99,
        stock: 15,
        category_id: 104,
        status: true,
        brand_id: brandNameToId['Mi'],
        created_at: new Date(),
        updated_at: new Date()
      },
      // Fans & Other appliances (category_id: 105)
      {
        id: 41,
        name: 'Havells Ceiling Fan',
        description: '1200mm Energy Saving Fan',
        slug: 'havells-ceiling-fan',
        sku: 'FAN-001',
        price: 2499.99,
        stock: 30,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Havells'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 42,
        name: 'Usha Table Fan',
        description: '400mm Table Fan',
        slug: 'usha-table-fan',
        sku: 'FAN-002',
        price: 1599.99,
        stock: 18,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Usha'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 43,
        name: 'Bajaj Pedestal Fan',
        description: 'High Speed Pedestal Fan',
        slug: 'bajaj-pedestal-fan',
        sku: 'FAN-003',
        price: 1999.99,
        stock: 22,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Bajaj'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 44,
        name: 'Orient Wall Fan',
        description: '400mm Wall Fan',
        slug: 'orient-wall-fan',
        sku: 'FAN-004',
        price: 1799.99,
        stock: 15,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Orient'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 45,
        name: 'Crompton Exhaust Fan',
        description: '250mm Exhaust Fan',
        slug: 'crompton-exhaust-fan',
        sku: 'FAN-005',
        price: 1299.99,
        stock: 20,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Crompton'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 46,
        name: 'V-Guard Pedestal Fan',
        description: 'High Speed Pedestal Fan',
        slug: 'v-guard-pedestal-fan',
        sku: 'FAN-006',
        price: 2199.99,
        stock: 13,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['V-Guard'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 47,
        name: 'Khaitan Table Fan',
        description: '300mm Table Fan',
        slug: 'khaitan-table-fan',
        sku: 'FAN-007',
        price: 1399.99,
        stock: 17,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Khaitan'],
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        id: 48,
        name: 'Polycab Ceiling Fan',
        description: '1200mm Decorative Fan',
        slug: 'polycab-ceiling-fan',
        sku: 'FAN-008',
        price: 2699.99,
        stock: 11,
        category_id: 105,
        status: true,
        brand_id: brandNameToId['Polycab'],
        created_at: new Date(),
        updated_at: new Date()
      }
    ]);

    // Then, create product variations
    await queryInterface.bulkInsert('product_variations', [
      {
        product_id: 1,
        sku: 'IP13P-001-128GB',
        price: 999.99,
        stock: 20,
        attributes: JSON.stringify({ storage: '128GB', color: 'Graphite' }),
        status: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        product_id: 1,
        sku: 'IP13P-001-256GB',
        price: 1099.99,
        stock: 30,
        attributes: JSON.stringify({ storage: '256GB', color: 'Graphite' }),
        status: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        product_id: 2,
        sku: 'MBP-M1-001-8GB',
        price: 1299.99,
        stock: 15,
        attributes: JSON.stringify({ ram: '8GB', storage: '256GB' }),
        status: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        product_id: 3,
        sku: 'MCT-001-S',
        price: 29.99,
        stock: 30,
        attributes: JSON.stringify({ size: 'S', color: 'Black' }),
        status: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        product_id: 3,
        sku: 'MCT-001-M',
        price: 29.99,
        stock: 40,
        attributes: JSON.stringify({ size: 'M', color: 'Black' }),
        status: true,
        created_at: new Date(),
        updated_at: new Date()
      }
    ]);
  },

  down: async (queryInterface, Sequelize) => {
    // Only delete the demo products
    await queryInterface.bulkDelete('product_variations', {
      product_id: {
        [Sequelize.Op.in]: [1, 2, 3] // Only delete the demo products
      }
    });
    await queryInterface.bulkDelete('products', {
      id: {
        [Sequelize.Op.in]: [1, 2, 3] // Only delete the demo products
      }
    });
  }
};